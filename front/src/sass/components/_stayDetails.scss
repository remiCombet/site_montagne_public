@use '../utils/variables' as vars;
@use '../utils/mixins' as mix;
@use './editableComponent';

// Variables spécifiques aux détails du séjour
$details-active-bg: rgba(vars.$primary-color, 0.08);
$details-active-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);

// Classes de niveau pour la visualisation
$level-colors: (
  "facile": #78c578,
  "modéré": #8fc9e3,
  "sportif": #ffcb47,
  "difficile": #ff9a7a,
  "extreme": #ff6b6b
);

.stay-details-management {
  @extend .editable-component;
  
  // Spécifique au mode vue
  .stay-details-view {
    @extend .view-mode;
    
    .details-header {
      @extend .component-header;
      
      // Styles pour les onglets
      .details-tabs {
        display: flex;
        border-bottom: 1px solid vars.$border-color;
        margin-bottom: vars.$spacing-md;
        
        // Style en colonne sur mobile
        @include mix.for-size('mobile') {
          flex-direction: column;
          gap: vars.$spacing-xs;
          
          .tab-button {
            width: 100%;
            border-radius: vars.$border-radius;
            border: 1px solid vars.$border-color;
            
            &.active {
              background-color: rgba(vars.$primary-color, 0.1);
              border-color: vars.$primary-color;
            }
          }
        }
        
        // Style en ligne sur tablette et desktop
        @include mix.for-size('tablet') {
          flex-direction: row;
          
          .tab-button {
            border-bottom: 3px solid transparent;
            margin-right: vars.$spacing-sm;
          }
        }
        
        .tab-button {
          padding: vars.$spacing-sm vars.$spacing-md;
          background: transparent;
          border: none;
          color: vars.$text-color;
          font-weight: 500;
          transition: all vars.$transition-speed ease;
          cursor: pointer;
          
          &:hover {
            color: vars.$primary-color;
            border-color: rgba(vars.$primary-color, 0.3);
          }
          
          &.active {
            color: vars.$primary-color;
            border-bottom-color: vars.$primary-color;
            font-weight: 600;
          }
          
          &:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(vars.$primary-color, 0.3);
          }
        }
      }
      
      // Styles pour la liste des informations
      .stay-info-list {
        padding: 0;
        margin: vars.$spacing-md 0;
        
        .stay-info-item {
          margin-bottom: vars.$spacing-md;
          
          // En colonne par défaut (mobile)
          display: flex;
          flex-direction: column;
          
          // En ligne sur tablette et plus
          @include mix.for-size('tablet') {
            flex-direction: row;
            align-items: baseline;
          }
          
          dt {
            font-weight: 600;
            color: vars.$primary-color;
            margin-bottom: vars.$spacing-xs;
            
            // Largeur fixe sur tablette et plus
            @include mix.for-size('tablet') {
              flex: 0 0 150px;
              margin-bottom: 0;
            }
          }
          
          dd {
            margin: 0;
            flex: 1;
            
            &.level {
              display: inline-block;
              padding: vars.$spacing-xs vars.$spacing-sm;
              border-radius: vars.$border-radius-pill;
              color: vars.$white;
              font-weight: 500;
              text-transform: capitalize;
              
              // Couleurs des niveaux
              @each $level, $color in $level-colors {
                &.level-#{$level} {
                  background-color: $color;
                }
              }
            }
          }
        }
      }
      
      // Styles pour le point de réception en mode vue
      .stay-reception-point {
        padding: vars.$spacing-sm 0;
        
        h4 {
          color: vars.$primary-color;
          margin-bottom: vars.$spacing-md;
        }
      }
    }
    
    .details-action {
      @extend .component-action;
    }
  }
  
  // Spécifique au mode édition
  .stay-details-edit {
    @extend .edit-mode;
    
    // Styles pour les onglets en mode édition
    .details-tabs {
      display: flex;
      border-bottom: 1px solid vars.$border-color;
      margin-bottom: vars.$spacing-md;
      
      // Style en colonne sur mobile
      @include mix.for-size('mobile') {
        flex-direction: column;
        gap: vars.$spacing-xs;
        
        .tab-button {
          width: 100%;
          border-radius: vars.$border-radius;
          border: 1px solid vars.$border-color;
          
          &.active {
            background-color: rgba(vars.$primary-color, 0.1);
            border-color: vars.$primary-color;
          }
        }
      }
      
      // Style en ligne sur tablette et desktop
      @include mix.for-size('tablet') {
        flex-direction: row;
        
        .tab-button {
          border-bottom: 3px solid transparent;
          margin-right: vars.$spacing-sm;
        }
      }
      
      .tab-button {
        padding: vars.$spacing-sm vars.$spacing-md;
        background: transparent;
        color: vars.$text-color;
        font-weight: 500;
        transition: all vars.$transition-speed ease;
        cursor: pointer;
        
        &:hover:not(:disabled) {
          color: vars.$primary-color;
          border-color: rgba(vars.$primary-color, 0.3);
        }
        
        &.active {
          color: vars.$primary-color;
          border-bottom-color: vars.$primary-color;
          font-weight: 600;
        }
        
        &:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }
        
        &:focus {
          outline: none;
          box-shadow: 0 0 0 2px rgba(vars.$primary-color, 0.3);
        }
      }
    }
    
    // Animation pour transition du message
    .alert {
      transition: opacity 0.3s ease-in-out;
      
      &.fade-out {
        opacity: 0;
      }
    }
    
    // Formulaire d'édition
    .stay-edit-form {
      background-color: vars.$white;
      padding: vars.$spacing-md;
      border-radius: vars.$border-radius;
      margin-bottom: vars.$spacing-md;
      box-shadow: vars.$box-shadow;
      @include mix.smooth-transition(all);
      width: 100%;
      
      .stay-edit-fieldset {
        margin-bottom: vars.$spacing-lg;
        border: none;
        padding: 0;
        
        legend {
          font-weight: 600;
          color: vars.$primary-color;
          margin-bottom: vars.$spacing-md;
          padding-bottom: vars.$spacing-xs;
          border-bottom: vars.$border-width solid vars.$border-light;
          width: 100%;
        }
      }
    
      .form-row {
        @include mix.flex(column, flex-start, stretch);
        gap: vars.$spacing-md;
        margin-bottom: vars.$spacing-md;
        
        @include mix.for-size('tablet') {
          @include mix.flex(row, space-between, flex-start);
          
          .form-group {
            flex: 1;
          }
        }
      }
      
      // Styles pour les sélecteurs
      .select-input {
        width: 100%;
        padding: vars.$spacing-sm;
        border: vars.$border-width solid vars.$input-border;
        border-radius: vars.$border-radius;
        background-color: vars.$white;
        
        &:focus {
          outline: none;
          border-color: vars.$primary-color;
        }
        
        &:disabled {
          background-color: vars.$background-light;
          cursor: not-allowed;
        }
      }
      
      // Styles pour l'input de date
      .date-input {
        width: 100%;
        padding: vars.$spacing-sm;
        border: vars.$border-width solid vars.$input-border;
        border-radius: vars.$border-radius;
        
        &:focus {
          outline: none;
          border-color: vars.$primary-color;
        }
        
        &:disabled {
          background-color: vars.$background-light;
          cursor: not-allowed;
        }
      }
    }
    
    // Section pour le point de réception
    .reception-point-section {
      background-color: vars.$white;
      padding: vars.$spacing-md;
      border-radius: vars.$border-radius;
      margin-bottom: vars.$spacing-md;
      box-shadow: vars.$box-shadow;
      
      h4 {
        color: vars.$primary-color;
        margin-top: 0;
        margin-bottom: vars.$spacing-md;
      }
    }
    
    // Footer du mode édition
    .details-edit-footer {
      @extend .edit-footer;
    }
  }
}